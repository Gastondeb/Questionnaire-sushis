<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sushi Form</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fjalla+One&display=swap">
    <style>

                /* Style de base */
                body {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            position: relative;
            background: url('fondsushis.png') center center no-repeat;
            background-size: cover;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Fjalla One', sans-serif;
        }

        /* Styles am√©lior√©s pour le texte de la page d'accueil */
        .intro-text {
            margin: 0 auto 15px;
            max-width: 90%;
        }

        .tagline {
            font-size: 3.8vmin;
            font-weight: bold;
            margin-bottom: 12px;
            letter-spacing: 0.5px;
            color: #333;
        }

        .highlight {
            color: #ff6f61;
            position: relative;
        }

        .highlight::after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #ff6f61;
            border-radius: 1px;
        }

        .description {
            font-size: 3.5vmin;
            line-height: 1.4;
            margin-bottom: 12px;
            color: #444;
        }

        .call-to-action {
            font-size: 3.2vmin;
            font-weight: bold;
            font-style: italic;
            color: #333;
            margin-bottom: 15px;
        }

        /* Adaptation responsive */
        @media (max-width: 600px) {
            .tagline {
                font-size: 3.5vmin;
            }
            
            .description {
                font-size: 3.2vmin;
            }
            
            .call-to-action {
                font-size: 3vmin;
            }
        }

        .icon {
            font-size: 6vmin;
            margin-right: 10px;
        }

        .person-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1em;
            height: 1em;
            margin-right: 10px;
        }

        .person-icon svg {
            width: 100%;
            height: 100%;
            transition: fill 0.3s ease;
        }

        .person-icon:hover svg {
            fill: #ffa580;
        }

        .welcome-text {
            font-size: 4vmin;
            margin: 0 0 20px 0;
            color: #333;
            font-style: italic;
            text-align: center;
            position: relative;
        }

        .first-question .welcome-text {
            margin-top: 0;
        }

        /* Style pour centrer les questions personnelles */
        .first-question, .question:nth-child(2), .question:nth-child(3) {
            justify-content: center;
            padding-top: 0;
            padding-bottom: 0;
            height: 100%;
        }

        .first-question label, .question:nth-child(2) label, .question:nth-child(3) label {
            margin-bottom: 15px;
        }

        .first-question input, .question:nth-child(2) input, .question:nth-child(3) input {
            margin-bottom: 15px;
        }

        .question input {
            padding: 4%;
            font-size: 5vmin;
            border: 3px solid black;
            box-shadow: 3px 3px 1px black;
            width: 80%;
            margin-bottom: 5%;
            border-radius: 15px;
            transition: border-color 0.3s ease;
        }

        .question input:focus {
            border-color: #ff6f61;
        }

        /* ----- Page d'accueil ----- */
        .home-page {
            text-align: center;
            color: black;
            background: #f8f4e5;
            padding: 5%;
            padding-bottom: 80px;
            border: 2px solid black;
            box-shadow: 15px 15px 1px #ffa580, 15px 15px 1px 2px black;
            border-radius: 15px;
            width: 80vmin;
            min-height: auto;
            height: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-sizing: border-box;
        }

        /* Logo principal */
        .main-logo {
            height: 18vmin;
            width: auto;
            max-width: 80vw;
            object-fit: contain;
            transform: scale(3) translateY(-20%); /* R√©duit de scale(4) √† scale(3) */
            transform-origin: center top;
            display: block;
            margin: 0 auto;
        }

        /* Conteneur du logo */
        .logo-wrapper {
            flex: 0 0 auto;
            margin-bottom: 20px; /* L√©g√®rement r√©duit aussi */
            max-height: 28vh;
            overflow: visible;
            position: relative;
        }

        /* Texte descriptif */
        .home-page p {
            font-size: 4vmin;
            margin-bottom: 5%;
            padding: 0 10px;
        }

        /* Bouton de commande */
        .home-page .order-btn {
            position: relative;
            bottom: auto;
            left: auto;
            transform: none;
            width: 80%;
            max-width: 300px;
            padding: 12px 20px;
            font-size: 4vmin;
            background: #ffa580; 
            color: white;
            border: 2px solid black;
            cursor: pointer;
            transition: 0.2s all ease-in-out;
            box-shadow: 3px 3px 1px black;
            border-radius: 10px;
            margin: 20px auto 0;
            display: block;
        }

        .home-page .order-btn:hover {
            background: black;
            color: white;
        }

        /* ----- Version Mobile ----- */

        /* R√®gle globale pour uniformiser tous les boutons */
        .order-btn, .select-btn, .nav-btn, .delivery-btn-vertical, .compact-btn {
            background: #ffa580 !important;
        }

        /* Garder le style pour les boutons s√©lectionn√©s */
        .select-btn.selected {
            background: black !important;
            color: white !important;
        }

        /* Adaptation responsive */
        @media (max-width: 600px) {
            .home-page {
                padding-bottom: 70px;
                width: 90vmin;
            }
            
            .main-logo {
                height: 16vmin;
                transform: scale(2.7) translateY(-20%); /* R√©duit √©galement sur mobile */
            }
            
            .home-page .order-btn {
                bottom: 15px;
                width: 85%;
                font-size: 3.8vmin;
            }
        }

        .home-page p {
            font-size: 4vmin;
            margin-bottom: 10%;
        }

        .home-page .order-btn:hover {
            background: black;
            color: white;
        }

        /* Formulaire */
        .contact-us {
            display: none;
            background: #f8f4e5;
            padding: 5% 5% 5% 5%;
            border: 2px solid black;
            box-shadow: 15px 15px 1px #ffa580, 15px 15px 1px 2px black;
            text-align: center;
            width: 80vmin;
            height: auto;
            min-height: 90vmin;
            max-height: 95vh;
            overflow-y: auto;
            flex-direction: column;
            justify-content: center;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .question {
            display: none;
            text-align: center;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            height: 85%;
        }

        .question.active {
            display: flex;
        }

        .question h2 {
            font-size: 6vmin;
            text-align: center;
            margin-top: 0;
            margin-bottom: 5%;
            color: #333;
            font-family: 'Fjalla One', sans-serif;
        }

        .question label {
            font-size: 6vmin;
            margin-bottom: 5%;
        }

        .btn-group, .question input {
            align-self: center;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 5%;
            margin-top: 5%;
        }

        .select-btn {
            padding: 4% 6%;
            background: #ffa580; /* Chang√© en orange pour toutes les questions */
            color: white;
            font-weight: bold;
            border: 2px solid black;
            cursor: pointer;
            transition: 0.2s all ease-in-out;
            box-shadow: 3px 3px 1px black;
            font-size: 4vmin;
            border-radius: 15px;
            min-width: 120px;
        }

        .select-btn.selected {
            background: black;
            color: white;
        }

        .nav-container {
            display: flex;
            justify-content: center;
            position: absolute;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
        }

        /* Style pour les boutons de navigation √©galement */
        .nav-btn {
            padding: 3% 6%;
            font-size: 4vmin;
            background: #ffa580; /* Uniformis√© avec l'orange */
            border: 1px solid black;
            cursor: pointer;
            transition: 0.2s all ease-in-out;
            box-shadow: 3px 3px 1px black;
            border-radius: 10px;
            width: 100%;
            max-width: 200px;
            color: white;
        }

        .nav-btn:hover {
            background: black;
            color: white;
        }

        .submit-btn {
            padding: 3% 6%;
            font-size: 4vmin;
            background: #ffa580;
            border: 1px solid black;
            cursor: pointer;
            transition: 0.2s all ease-in-out;
            box-shadow: 3px 3px 1px black;
            display: none;
            border-radius: 10px;
            width: 100%;
            max-width: 200px;
            color: white;
        }

        .submit-btn.visible {
            display: block;
        }

        .error-message {
            color: red;
            font-size: 3.5vmin;
            margin-top: 3%;
            display: none;
        }

        /* Styles sp√©cifiques */
        .question-title {
            margin-bottom: 25px;
            font-size: 8vmin;
            text-align: center;
            margin: 0;
            color: #fff;
            font-family: 'Fjalla One', sans-serif;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            display: block;
            padding: 10px 20px;
            background: linear-gradient(45deg, #ff6f61, #ffa580);
            border: 2px solid #ff6f61;
            border-radius: 15px;
            box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            box-sizing: border-box;
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%) rotate(-1deg);
            z-index: 10;
        }
        @media (max-width: 600px) {
            .ingredient-question .supplement-info {
                margin-top: 25px; /* Plus d'espace sur les petits √©crans */
                display: block; /* Assurez-vous qu'il s'agit d'un bloc distinct */
                clear: both; /* √âvite les superpositions avec d'autres √©l√©ments */
            }
            
            .question-title {
                margin-bottom: 30px; /* Plus d'espace sur mobile */
            }
        }

        .ingredient-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 5%;
            margin-top: -20px;
        }

        .ingredient-image {
            width: 80px;
            height: auto;
            border-radius: 10px;
            opacity: 0.8;
        }

        .ingredient-image:first-child {
            transform: rotate(-5deg);
        }

        .ingredient-image:last-child {
            transform: rotate(5deg);
        }

        .supplement-info {
            font-size: 3.5vmin;
            color: #555;
            margin-top: 20px; /* Augment√© de 1vmin √† 20px */
            position: relative;
            z-index: 5; /* R√©duit de 20 √† 5 pour √©viter les conflits de superposition */
        }

        /* Page r√©cap */
        .recap-page {
            padding: 2vmin;
            font-size: 2.7vmin;
        }

        .recap-page h2 {
            font-size: 4vmin;
            margin-bottom: 2vmin;
        }

        .recap-page h3 {
            font-size: 3.2vmin;
            margin-bottom: 1.5vmin;
        }

        .recap-page p {
            font-size: 2.7vmin;
            margin: 1.2vmin 0;
            line-height: 1.2;
        }

        .recap-page button {
            padding: 1vmin 2vmin;
            font-size: 2.5vmin;
            background: #ff6f61;
            color: white;
            border: 1px solid black;
            cursor: pointer;
            transition: 0.2s all ease-in-out;
            box-shadow: 2px 2px 1px black;
            border-radius: 5px;
            margin: 1vmin 0;
        }

        .recap-page button:hover {
            background: black;
            color: white;
        }

        #recap-content {
            margin: 2vmin 0;
        }

        #recap-price h3 {
            font-size: 3.5vmin;
            margin-top: 2vmin;
        }

        /* Page de remerciement */
        .thank-you-page {
            display: none;
            text-align: center;
            padding: 20px;
            background: #f8f4e5;
            border-radius: 15px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        .thank-you-page h2 {
            color: #ff6f61;
            font-size: 6vmin;
            margin-bottom: 20px;
        }

        .thank-you-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .thank-you-content p {
            font-size: 4vmin;
            margin: 15px 0;
            color: #333;
        }

        .thank-you-sushi {
            width: 100px;
            margin: 20px auto;
            animation: bounce 0.5s infinite alternate;
        }

        .contact-info {
            font-size: 3.5vmin;
            color: #ff6f61;
            margin-top: 20px;
            font-weight: bold;
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .select-btn {
                font-size: 3vmin;
                padding: 2vmin 3vmin;
                min-width: 80px;
            }

            .btn-group {
                flex-wrap: wrap;
                gap: 10px;
            }

            .question-title {
                font-size: 6vmin;
                padding: 8px 15px;
                top: 15px;
            }

            .welcome-text {
                margin-bottom: 15px;
            }
            
            .first-question, .question:nth-child(2), .question:nth-child(3) {
                justify-content: center;
            }
        }

        /* Style du bouton d√©sactiv√© */
        .order-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
            transform: none !important;
            box-shadow: none !important;
        }

        /* Style pendant le chargement */
        .order-btn[disabled] {
            background: #f8f4e5 !important;
            color: #999 !important;
            border-color: #ccc !important;
            cursor: wait !important;
        }

        /* Nouveau style compact */
        .compact-btn {
            padding: 1.5% 4% !important;
            font-size: 3.8vmin !important;
            min-width: 120px !important;
            transition: all 0.2s ease !important;
        }

        /* Effet hover adapt√© */
        .compact-btn:hover {
            transform: scale(1.05) !important; 
            box-shadow: 4px 4px 2px black !important;
        }

        /* Style pour l'image de choix */
        .box-choice-image {
            text-align: center;
            margin: 10px 0 20px;
        }
        .box-choice-image img {
            max-height: 240px;
            background-color: transparent;
        }

        /* Style sp√©cifique pour les boutons de quantit√© */
        .box-quantity-btns .select-btn {
            padding: 2% 4% !important;
            font-size: 3.5vmin !important;
            margin: 0 5px;
        }

        /* Adaptation responsive */
        @media (max-width: 600px) {
            .box-quantity-btns .select-btn {
                font-size: 4vmin !important;
                padding: 3% 5% !important;
            }
            
            .box-choice-image img {
                max-height: 200px; /* Augment√© sur mobile √©galement */
            }
        }

        /* Barre de progression */
        .progress-container {
            width: 80%;
            height: 15px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 0 auto;
            display: none;
            position: absolute;
            bottom: 8%;
            left: 0;
            right: 0;
            max-width: 400px;
        }

        .progress-bar {
            height: 100%;
            border-radius: 10px;
            background: linear-gradient(45deg, #ff6f61, #ffa580);
            width: 0%;
            transition: width 0.5s ease;
        }
        /* Style personnalis√© pour les images de fromage */
        .fromage-image {
            width: 55px !important; /* Taille r√©duite, ajustez selon vos besoins */
            height: auto;
            transform: scale(0.8); /* R√©duction suppl√©mentaire */
        }
        /* Style pour les boutons de livraison verticaux */
        .delivery-buttons-vertical {
            display: flex;
            flex-direction: column; /* Affiche les √©l√©ments en colonne */
            align-items: center;    /* Centre les boutons horizontalement */
            gap: 12px;             /* Espace entre les boutons */
            width: 80%;            /* Largeur du conteneur */
            margin: 0 auto;        /* Centre le conteneur */
            margin-bottom: 50px;   /* Espace sous les boutons pour la barre de progression */
        }

/* Remplacer le style existant pour les boutons de livraison verticaux */
.delivery-btn-vertical {
    width: 100%;          /* Garder pour conserver l'alignement */
    max-width: 200px;     /* R√©duit de 280px √† 200px */
    padding: 2% 4% !important;  /* R√©duit de 8px 15px √† 2% 4% comme les boutons d'ingr√©dients */
    font-size: 3.5vmin !important;  /* R√©duit de 3.8vmin √† 3.5vmin */
    line-height: 1.2;     /* L√©g√®rement r√©duit */
    min-height: 35px;     /* R√©duit de 45px √† 35px */
}

/* Ajuster la taille du texte de l'√©tiquette au-dessus des boutons */
.delivery-label {
    font-size: 4vmin !important;  /* R√©duit de 4.5vmin √† 4vmin */
    margin-bottom: 10px !important;  /* R√©duit de 15px √† 10px */
}

/* Ajuster les espacements dans le conteneur des boutons */
.delivery-buttons-vertical {
    gap: 8px;  /* R√©duit de 12px √† 8px */
    margin-bottom: 40px;  /* R√©duit de 50px √† 40px */
}

/* Ajuster pour le mobile */
@media (max-width: 600px) {
    .delivery-buttons-vertical {
        margin-bottom: 50px;  /* R√©duit de 60px √† 50px */
    }
    
    .delivery-btn-vertical {
        font-size: 3.2vmin !important;  /* R√©duit de 3.5vmin √† 3.2vmin */
        padding: 8px !important;  /* R√©duit de 10px √† 8px */
    }
}
.delivery-label {
            font-size: 3.5vmin !important; /* R√©duit de 4vmin √† 3.5vmin */
            margin-bottom: 8px !important; /* R√©duit de 10px √† 8px */
            font-weight: bold;
            color: #333;
        }
        
        /* Style pour l'image de la bo√Æte sur la page de livraison */
        .delivery-box-image {
            max-width: 120px !important; /* R√©duit de 140px √† 120px */
            margin: 30px 0 8px 0 !important; /* Ajust√© pour un meilleur espacement */
            background-color: transparent;
            border-radius: 0;
            box-shadow: none;
        }
        
        /* Ajustement des boutons de livraison */
        .delivery-btn-vertical {
            width: 100%;
            max-width: 200px;
            padding: 1.8% 3.5% !important; /* L√©g√®rement r√©duit */
            font-size: 3.2vmin !important; /* R√©duit de 3.5vmin √† 3.2vmin */
            line-height: 1.2;
            min-height: 32px; /* R√©duit de 35px √† 32px */
        }
        
        /* Ajustement pour le mobile */
        @media (max-width: 600px) {
            .delivery-btn-vertical {
                font-size: 3vmin !important; /* R√©duit de 3.2vmin √† 3vmin */
                padding: 7px !important; /* R√©duit de 8px √† 7px */
            }
            
            .delivery-label {
                font-size: 3.2vmin !important; /* R√©duit de 3.5vmin √† 3.2vmin */
            }
            
            .delivery-box-image {
                max-width: 110px !important; /* Encore plus petit sur mobile */
            }
        }
        .ingredient-question .supplement-info {
            position: relative;
            z-index: 20; /* Plus √©lev√© que le z-index de question-title (10) */
            margin-top: 5px; /* Un petit espace apr√®s le titre */
        }

    </style>
</head>
<body>
    
    <div class="home-page">
        <div class="logo-wrapper">
            <h1>
                <img src="titre.png" alt="Logo" class="main-logo">
            </h1>
        </div>
        
        <!-- Texte am√©lior√© avec mise en forme -->
        <div class="intro-text">
          
            <p class="description">
                D√©couvrez mes makis artisanaux, pr√©par√©s avec soin et des ingr√©dients s√©lectionn√©s, √† des prix adapt√©s aux budgets √©tudiants.
            </p>
            <p class="call-to-action">
                Places limit√©es ‚Äì R√©servez d√®s maintenant !
            </p>
        </div>
        
        <div id="stock-display" style="margin-bottom: 20px; font-size: 3.5vmin; font-weight: bold; color: #ff6f61;">
            Chargement des stocks disponibles...
        </div>
        <button class="order-btn compact-btn" onclick="showForm()" id="main-order-btn">
            <span class="btn-loader" style="display:none;">Chargement...</span>
            <span class="btn-text">Commander</span>
        </button>
        
    </div>

    <!-- Formulaire -->
    <form class="contact-us" 
      action="https://docs.google.com/forms/d/e/1FAIpQLSec7_Wp_tyjnlGvlaTr4Ri172SPFX117Etf8mK6v7iTr1vp0Q/formResponse" 
      method="POST"
      target="_blank">
        
        <!-- Titre fixe pour les questions d'ingr√©dients -->
       

        <!-- Questions d'informations personnelles (SANS titre) -->
        <div class="question active first-question">
            <div class="welcome-text">
                Avant de te pr√©parer tes sushis sur mesure, on a besoin de quelques infos !
            </div>
            <label for="entry.524815907">
                <span class="icon person-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="#ff6f61" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </span> Comment tu t'appelles ?
            </label>
            <input type="text" name="entry.524815907" placeholder="Jean Paul" required>
            <div class="error-message">Veuillez r√©pondre √† cette question.</div>
        </div>

        <div class="question">
            <div class="welcome-text">
                Avant de te pr√©parer tes sushis sur mesure, on a besoin de quelques infos !
            </div>
            <label for="entry.1876625947">
                <span class="icon">üì±</span> Quel est ton num√©ro de t√©l√©phone ?
            </label>
            <input type="tel" name="entry.1876625947" placeholder="06 12 34 56 78" required>
            <div class="error-message">Veuillez r√©pondre √† cette question.</div>
        </div>

        <div class="question">
            <div class="welcome-text">
                Avant de te pr√©parer tes sushis sur mesure, on a besoin de quelques infos !
            </div>
            <label for="entry.1985104958">
                <span class="icon">üè†</span> Tu habites dans quelle colloc ?
            </label>
            <input type="text" name="entry.1985104958" placeholder="b43" required>
            <div class="error-message">Veuillez r√©pondre √† cette question.</div>
        </div>

        
        <!-- Nouvelle question pour le nombre de bo√Ætes -->
        <div class="question">
            <h2>Combien de bo√Ætes veux-tu ?</h2>
            
            <div class="box-choice-image">
                <img src="imageboite.png" alt="Bo√Æte de sushis" onerror="this.onerror=null; this.src='boite.png';" 
                style="max-width: 140px; margin: 10px 0; background-color: transparent; border-radius: 0; box-shadow: none;">
            </div>
            
            <p style="font-size: 3.8vmin; font-weight: bold; margin: 10px 0 15px; color: #ff6f61;">
                1 bo√Æte = 8 makis | 2 bo√Ætes = 16 makis
            </p>
            
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectBoxQuantity(this, 1)">1 bo√Æte (6,50 ‚Ç¨)</button>
                <button type="button" class="select-btn compact-btn" onclick="selectBoxQuantity(this, 2)">2 bo√Ætes (13,00 ‚Ç¨)</button>
            </div>
            <input type="hidden" name="entry.557485338" id="entry.557485338" required>
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

       
            <!-- Questions sur les ingr√©dients (BO√éTE 1) - AVEC titre -->
        <div class="question ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 1</p>
            <div class="ingredient-container">
                <img src="avocat.png" alt="Avocat" class="ingredient-image">
                <label>Quel l√©gume ?</label>
                <img src="concombre.png" alt="Concombre" class="ingredient-image">
            </div>
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.1292076072', 'avocats')">Avocat</button>
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.1292076072', 'concombres')">Concombre</button>
            </div>
            <input type="hidden" name="entry.1292076072" id="entry.1292076072" required>
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

        <div class="question ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 1</p>
            <div class="ingredient-container">
                <img src="saumon.png" alt="Saumon" class="ingredient-image">
                <label>Quel poisson ?</label>
                <img src="crevette.png" alt="Crevette" class="ingredient-image">
            </div>
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.1726767774', 'Saumon')">Saumon</button>
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.1726767774', 'Crevettes')">Crevette</button>
            </div>
            <input type="hidden" name="entry.1726767774" id="entry.1726767774" required>
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

        <div class="question ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 1</p>
            <div class="ingredient-container">
                <img src="fromage.png" alt="Fromage" class="ingredient-image fromage-image">
                <label>Fromage frais ?</label>
                <img src="fromage.png" alt="Fromage" class="ingredient-image fromage-image">
            </div>
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.887168393', 'Oui')">Oui</button>
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.887168393', 'Non')">Non</button>
            </div>
            <input type="hidden" name="entry.887168393" id="entry.887168393" required>
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

        <div class="question ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 1</p>
            <p class="supplement-info">Suppl√©ment sauce soja : <strong>+0,40 ‚Ç¨</strong></p>
            <label>Soja ?</label>
            <div class="btn-group box-quantity-btns" style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                    <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.41252950', 'Sucr√©e')">Sucr√©e</button>
                    <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.41252950', 'Sal√©e')">Sal√©e</button>
                </div>
                <button type="button" class="select-btn compact-btn" style="width: 100%; max-width: 200px;" onclick="selectOption(this, 'entry.41252950', 'Pas de sauce')">Pas de sauce</button>
            </div>
            <input type="hidden" name="entry.41252950" id="entry.41252950" required>
            <div class="error-message">Veuillez choisir une option.</div>
        </div>
                
        <!-- Questions pour la deuxi√®me bo√Æte - AVEC titre -->
        <div class="question second-box ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 2</p>
            <div class="ingredient-container">
                <img src="avocat.png" alt="Avocat" class="ingredient-image">
                <label>Quel l√©gume ?</label>
                <img src="concombre.png" alt="Concombre" class="ingredient-image">
            </div>
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.2021454936', 'avocats')">Avocat</button>
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.2021454936', 'concombres')">Concombre</button>
            </div>
            <input type="hidden" name="entry.2021454936" id="entry.2021454936">
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

        <div class="question second-box ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 2</p>
            <div class="ingredient-container">
                <img src="saumon.png" alt="Saumon" class="ingredient-image">
                <label>Quel poisson ?</label>
                <img src="crevette.png" alt="Crevette" class="ingredient-image">
            </div>
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.819843500', 'Saumon')">Saumon</button>
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.819843500', 'Crevettes')">Crevette</button>
            </div>
            <input type="hidden" name="entry.819843500" id="entry.819843500">
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

        <div class="question second-box ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 2</p>
            <div class="ingredient-container">
                <img src="fromage.png" alt="Fromage" class="ingredient-image fromage-image">
                <label>Fromage frais ?</label>
                <img src="fromage.png" alt="Fromage" class="ingredient-image fromage-image">
            </div>
            <div class="btn-group box-quantity-btns">
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.516077606', 'Oui')">Oui</button>
                <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.516077606', 'Non')">Non</button>
            </div>
            <input type="hidden" name="entry.516077606" id="entry.516077606">
            <div class="error-message">Veuillez choisir une option.</div>
        </div>
       
        <div class="question second-box ingredient-question">
            <h2 class="question-title">Que veux-tu dans ton maki ?</h2>
            <p class="supplement-info">Bo√Æte 2</p>
            <p class="supplement-info">Suppl√©ment sauce soja : <strong>+0,40 ‚Ç¨</strong></p>
            <label>Soja ?</label>
            <div class="btn-group box-quantity-btns" style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                    <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.1450345325', 'Sucr√©e')">Sucr√©e</button>
                    <button type="button" class="select-btn compact-btn" onclick="selectOption(this, 'entry.1450345325', 'Sal√©e')">Sal√©e</button>
                </div>
                <button type="button" class="select-btn compact-btn" style="width: 100%; max-width: 200px;" onclick="selectOption(this, 'entry.1450345325', 'Pas de sauce')">Pas de sauce</button>
            </div>
            <input type="hidden" name="entry.1450345325" id="entry.1450345325">
            <div class="error-message">Veuillez choisir une option.</div>
        </div>

        <div class="question ingredient-question">

            <h2 style="font-size: 5vmin; margin-top: 15px; color: #333; text-align: center;">Comment souhaites-tu r√©cup√©rer ta commande ?</h2>
            <p class="supplement-info">Suppl√©ment livraison : <strong>+0,40 ‚Ç¨</strong></p>
            <div class="box-choice-image" style="position: relative; z-index: 15;">
                <img src="Boite.png" alt="Bo√Æte de sushis" onerror="this.onerror=null; this.src='boite.png';" 
                class="delivery-box-image">
            </div>

            <div class="btn-group delivery-buttons-vertical">
                <button type="button" class="select-btn delivery-btn-vertical" onclick="selectOption(this, 'entry.554098723', 'Livraison chez moi (+0,40‚Ç¨)')">Livraison chez moi (+0,40‚Ç¨)</button>
                <button type="button" class="select-btn delivery-btn-vertical" onclick="selectOption(this, 'entry.554098723', 'Je viens la chercher')">Je viens la chercher</button>
            </div>

            <input type="hidden" name="entry.554098723" id="entry.554098723" required>
            <div class="error-message">Veuillez choisir une option.</div>

        </div>

        <!-- Page r√©capitulative -->
        <div class="question recap-page">
            <h2>R√©capitulatif de votre commande</h2>
            <div id="recap-content"></div>
            <div id="recap-price"></div>
            <div class="btn-group">
                <button type="button" class="nav-btn" onclick="confirmOrder()">Confirmer la commande</button>
              </div>
              
            <div class="error-message">Veuillez confirmer votre commande.</div>
        </div>

        <!-- Nouvelle page de remerciement -->
  <!-- Dans la div thank-you-page, modifiez le contenu -->
<div class="question thank-you-page">
    <h2>Merci pour ta commande ! üéâ</h2>
    <div class="thank-you-content">
        <p>Ta commande a bien √©t√© enregistr√©e.</p>
        <img src="pagegarde1.png" alt="Sushi" class="thank-you-sushi">
        <!-- Nouvel √©l√©ment pour le message de livraison dynamique -->
        <p id="delivery-message" style="font-weight: bold; color: #ff6f61; font-size: 4.2vmin;"></p>
        <p>Si tu as un probl√®me avec ta commande,</p>
        <p class="contact-info">Contacte-moi au 07 69 54 23 28</p>
    </div>
</div>

<!-- Ensuite, modifiez la fonction confirmOrder() dans le JavaScript -->

        <!-- Navigation -->
        <div class="nav-container">
            <button type="button" class="nav-btn next-btn" onclick="nextQuestion()">Suivant</button>
            <button type="submit" class="nav-btn submit-btn">Envoyer</button>
        </div>
        
        <!-- Barre de progression -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </form>

    <script>

        // Variables globales
let availableBoxes = 0;
let currentQuestion = 0;
let boxQuantity = 1;
const personalInfoQuestions = 3;
const box1Questions = 4; // R√©duit de 5 √† 4 car la question de livraison est d√©plac√©e
const box2Questions = 4;
const deliveryQuestion = 1; // Nouvelle constante pour la question de livraison
const allQuestions = document.querySelectorAll(".question:not(.recap-page):not(.thank-you-page)");
const submitBtn = document.querySelector(".submit-btn");
const nextBtn = document.querySelector(".next-btn");

// Stocker les r√©ponses
let responses = {
    box1: {
        legume: "",
        poisson: "",
        fromageFrais: "",
        soja: "",
        livre: ""
    },
    box2: {
        legume: "",
        poisson: "",
        fromageFrais: "",
        soja: ""
    }
};

// Prix
const basePrice = 6.5;
const sojaSupplement = 0.4;
const deliverySupplement = 0.4;

// Afficher le formulaire
function showForm() {
    document.querySelector('.home-page').style.display = 'none';
    document.querySelector('.contact-us').style.display = 'flex';
    
    // D√©sactiver le bouton "2 bo√Ætes" s'il n'y a qu'une seule bo√Æte disponible
    setTimeout(() => {
        const boxButtonsContainer = document.querySelector('.box-quantity-btns');
        if (boxButtonsContainer) {
            const twoBoxesButton = boxButtonsContainer.querySelectorAll('.select-btn')[1]; // Le bouton "2 bo√Ætes"
            
            if (availableBoxes === 1) {
                twoBoxesButton.disabled = true;
                twoBoxesButton.style.opacity = '0.5';
                twoBoxesButton.style.cursor = 'not-allowed';
                twoBoxesButton.title = "Stock insuffisant";
                
                // V√©rifier si un message existe d√©j√†
                const existingMessage = boxButtonsContainer.parentNode.querySelector('p[data-stock-message="true"]');
                if (!existingMessage) {
                    // Ajouter un message d'information seulement s'il n'existe pas d√©j√†
                    const infoMessage = document.createElement('p');
                    infoMessage.textContent = "Une seule bo√Æte disponible en stock";
                    infoMessage.style.color = "#e74c3c";
                    infoMessage.style.fontSize = "3vmin";
                    infoMessage.style.fontWeight = "bold";
                    infoMessage.style.margin = "5px 0";
                    infoMessage.setAttribute('data-stock-message', 'true'); // Ajouter un attribut pour l'identifier
                    boxButtonsContainer.parentNode.insertBefore(infoMessage, boxButtonsContainer.nextSibling);
                }
            }
        }
    }, 100);
}

// S√©lectionner le nombre de bo√Ætes
function selectBoxQuantity(button, quantity) {
    // V√©rifier si le bouton est d√©sactiv√©
    if (button.disabled) {
        return;
    }
    
    // Si on demande 2 bo√Ætes mais qu'il n'y en a qu'une disponible
    if (quantity === 2 && availableBoxes === 1) {
        const errorMsg = button.closest(".question").querySelector(".error-message");
        errorMsg.textContent = "Stock insuffisant pour commander 2 bo√Ætes";
        errorMsg.style.display = "block";
        return;
    }
    
    boxQuantity = quantity;
    document.getElementById('entry.557485338').value = quantity;
    
    let buttons = button.parentElement.querySelectorAll(".select-btn");
    buttons.forEach(btn => btn.classList.remove("selected"));
    button.classList.add("selected");
    
    const errorMessage = button.closest(".question").querySelector(".error-message");
    errorMessage.style.display = "none";
    
    nextQuestion();
}

// Passer √† la question suivante
function nextQuestion() {
    const currentQuestionElement = allQuestions[currentQuestion];
    
    if (!validateQuestion(currentQuestionElement)) {
        return;
    }
    
    currentQuestionElement.classList.remove("active");
    currentQuestion++;
    
    // V√©rifier si nous sommes en mode d'√©dition
    const editingBox = document.body.getAttribute('data-editing-box');
    
    // Si nous √©ditons la bo√Æte 1 et avons termin√© les questions de la bo√Æte 1
    if (editingBox === '1' && currentQuestion >= personalInfoQuestions + 1 + box1Questions) {
        // Retourner directement au r√©capitulatif
        document.body.removeAttribute('data-editing-box');
        showRecap();
        return;
    }
    
    // Si nous √©ditons la bo√Æte 2 et avons termin√© les questions de la bo√Æte 2
    if (editingBox === '2' && currentQuestion >= personalInfoQuestions + 1 + box1Questions + box2Questions) {
        // Retourner directement au r√©capitulatif
        document.body.removeAttribute('data-editing-box');
        showRecap();
        return;
    }
    
    // Logique normale de progression
    if (currentQuestion === personalInfoQuestions) {
        // Question sur le nombre de bo√Ætes
        allQuestions[currentQuestion].classList.add("active");
    } 
    else if (currentQuestion === personalInfoQuestions + 1) {
        // Premi√®re question sur les ingr√©dients (bo√Æte 1)
        allQuestions[currentQuestion].classList.add("active");
    }
    else if (currentQuestion === personalInfoQuestions + 1 + box1Questions && boxQuantity === 2) {
        // Premi√®re question sur les ingr√©dients (bo√Æte 2)
        allQuestions[currentQuestion].classList.add("active");
    }
    else if (currentQuestion === personalInfoQuestions + 1 + box1Questions && boxQuantity === 1) {
        // Si une seule bo√Æte, aller √† la question de livraison apr√®s les questions de la bo√Æte 1
        const deliveryQuestionIndex = personalInfoQuestions + 1 + box1Questions + box2Questions;
        allQuestions[deliveryQuestionIndex].classList.add("active");
        currentQuestion = deliveryQuestionIndex;
    }
    else if (currentQuestion === personalInfoQuestions + 1 + box1Questions + box2Questions) {
        // Si deux bo√Ætes, aller √† la question de livraison apr√®s les questions de la bo√Æte 2
        allQuestions[currentQuestion].classList.add("active");
    }
    else if (currentQuestion === personalInfoQuestions + 1 + box1Questions + box2Questions + deliveryQuestion) {
        // Apr√®s la question de livraison, montrer le r√©capitulatif
        showRecap();
    }
    else {
        // Questions normales
        allQuestions[currentQuestion].classList.add("active");
    }
    
    updateButtons();
    updateProgressBar();
}

// Valider une question
function validateQuestion(question) {
    const input = question.querySelector("input, [type=hidden]");
    const errorMessage = question.querySelector(".error-message");

    if (!input.value) {
        errorMessage.style.display = "block";
        return false;
    } else {
        errorMessage.style.display = "none";
        return true;
    }
}

// S√©lectionner une option
function selectOption(button, inputName, value) {
    document.getElementById(inputName).value = value;

    const questionIndex = Array.from(allQuestions).indexOf(button.closest('.question'));
    const isBox2 = questionIndex >= personalInfoQuestions + 1 + box1Questions && 
                  questionIndex < personalInfoQuestions + 1 + box1Questions + box2Questions;
    const isDelivery = questionIndex === personalInfoQuestions + 1 + box1Questions + box2Questions;

    if (isBox2) {
        if (inputName.includes("entry.2021454936")) {
            responses.box2.legume = value;
        } else if (inputName.includes("entry.819843500")) {
            responses.box2.poisson = value;
        } else if (inputName.includes("entry.516077606")) {
            responses.box2.fromageFrais = value;
        } else if (inputName.includes("entry.1450345325")) {
            responses.box2.soja = value;
        }
    } else if (isDelivery) {
        responses.box1.livre = value;
    } else {
        if (inputName.includes("entry.1292076072")) {
            responses.box1.legume = value;
        } else if (inputName.includes("entry.1726767774")) {
            responses.box1.poisson = value;
        } else if (inputName.includes("entry.887168393")) {
            responses.box1.fromageFrais = value;
        } else if (inputName.includes("entry.41252950")) {
            responses.box1.soja = value;
        } else if (inputName.includes("entry.554098723")) {
            responses.box1.livre = value;
        }
    }

    let buttons = button.parentElement.querySelectorAll(".select-btn");
    buttons.forEach(btn => btn.classList.remove("selected"));
    button.classList.add("selected");

    const errorMessage = button.closest(".question").querySelector(".error-message");
    errorMessage.style.display = "none";

    nextQuestion();
}

// Mettre √† jour la barre de progression
function updateProgressBar() {
    const progressContainer = document.querySelector('.progress-container');
    const progressBar = document.getElementById('progressBar');
    const recapPageActive = document.querySelector('.recap-page.active');
    const thankYouPageActive = document.querySelector('.thank-you-page.active');

    // Si nous sommes sur la page de r√©cap ou de remerciement, on cache la barre
    if (recapPageActive || thankYouPageActive) {
        progressContainer.style.display = 'none';
        return;
    }

    // Si nous sommes apr√®s les questions personnelles
    if (currentQuestion > personalInfoQuestions) {
        progressContainer.style.display = 'block';
        
        // Calculer le nombre total de questions √† afficher selon le nombre de bo√Ætes
        let totalQuestions = personalInfoQuestions + 1; // Questions personnelles + question nombre de bo√Ætes
        
        // Ajouter les questions pour la/les bo√Æte(s)
        if (boxQuantity === 1) {
            totalQuestions += box1Questions + deliveryQuestion;
        } else {
            totalQuestions += box1Questions + box2Questions + deliveryQuestion;
        }
        
        // Calculer la position actuelle dans le flux de questions
        let currentPosition = currentQuestion;
        
        // Ajuster la position si on a saut√© des questions (cas d'une seule bo√Æte)
        if (boxQuantity === 1 && currentQuestion > personalInfoQuestions + 1 + box1Questions) {
            currentPosition = personalInfoQuestions + 1 + box1Questions + deliveryQuestion 
                            - (personalInfoQuestions + 1 + box1Questions + box2Questions + deliveryQuestion - currentQuestion);
        }
        
        // Calculer le pourcentage de progression
        const progress = ((currentPosition - personalInfoQuestions) / (totalQuestions - personalInfoQuestions)) * 100;
        
        // Limiter la progression √† 100% maximum
        const clampedProgress = Math.min(progress, 100);
        
        progressBar.style.width = `${clampedProgress}%`;
    } else {
        progressContainer.style.display = 'none';
    }
}
// Afficher le r√©capitulatif
function showRecap() {
    const recapPage = document.querySelector(".recap-page");
    const recapContent = document.getElementById("recap-content");
    const recapPrice = document.getElementById("recap-price");
    
    // Masquer le titre s'il existe
    const questionTitle = document.querySelector('.question-title');
    if (questionTitle) {
        questionTitle.style.display = 'none';
    }
    
    let totalPrice = basePrice;
    if (boxQuantity === 2) totalPrice += basePrice;
    
    recapContent.innerHTML = `
        <div class="recap-section">
            <h3>Bo√Æte 1 : 6,50 ‚Ç¨</h3>
            <p><strong>L√©gume:</strong> ${responses.box1.legume}</p>
            <p><strong>Poisson:</strong> ${responses.box1.poisson}</p>
            <p><strong>Fromage:</strong> ${responses.box1.fromageFrais}</p>
            <p><strong>Soja:</strong> ${responses.box1.soja} ${responses.box1.soja !== 'Pas de sauce' ? '(+0,40 ‚Ç¨)' : ''}</p>
            <button type="button" onclick="goToBox1()">Modifier</button>
        </div>`;

    if (boxQuantity === 2) {
        recapContent.innerHTML += `
        <div class="recap-section">
            <h3>Bo√Æte 2 : 6,50 ‚Ç¨</h3>
            <p><strong>L√©gume:</strong> ${responses.box2.legume}</p>
            <p><strong>Poisson:</strong> ${responses.box2.poisson}</p>
            <p><strong>Fromage:</strong> ${responses.box2.fromageFrais}</p>
            <p><strong>Soja:</strong> ${responses.box2.soja} ${responses.box2.soja !== 'Pas de sauce' ? '(+0,40 ‚Ç¨)' : ''}</p>
            <button type="button" onclick="goToBox2()">Modifier</button>
        </div>`;
        
        if (responses.box2.soja === "Sucr√©e" || responses.box2.soja === "Sal√©e") totalPrice += sojaSupplement;
    }

    // Ajouter les informations de livraison au r√©capitulatif
    recapContent.innerHTML += `
    <div class="recap-section">
        <h3>R√©cup√©ration</h3>
        <p><strong>Mode:</strong> ${responses.box1.livre}</p>
        <button type="button" onclick="goToDelivery()">Modifier</button>
    </div>`;

    if (responses.box1.soja === "Sucr√©e" || responses.box1.soja === "Sal√©e") totalPrice += sojaSupplement;
    if (responses.box1.livre === "Livraison chez moi (+0,40‚Ç¨)") totalPrice += deliverySupplement;

    recapPrice.innerHTML = `<h3>Total : ${totalPrice.toFixed(2)}‚Ç¨</h3>`;

    allQuestions.forEach(q => q.classList.remove("active"));
    recapPage.classList.add("active");
    document.querySelector(".nav-container").style.display = "none";
    
    // Explicitement masquer la barre de progression
    document.querySelector('.progress-container').style.display = 'none';
}

// Fonction pour revenir √† la modification de la bo√Æte 1
function goToBox1() {
    const questionTitle = document.querySelector('.question-title');
    if (questionTitle) {
        questionTitle.style.display = 'block';
    }
    document.querySelector(".nav-container").style.display = "flex";
    currentQuestion = personalInfoQuestions + 1;            
    document.querySelector(".recap-page").classList.remove("active");
    allQuestions.forEach(q => q.classList.remove('active'));           
    allQuestions[currentQuestion].classList.add("active");           
    document.body.setAttribute('data-editing-box', '1');
    
    // Mettre √† jour l'interface
    updateButtons();
    updateProgressBar();
}

// Fonction pour revenir √† la modification de la bo√Æte 2
function goToBox2() {
    const questionTitle = document.querySelector('.question-title');
    if (questionTitle) {
        questionTitle.style.display = 'block';
    }
    document.querySelector(".nav-container").style.display = "flex";
    currentQuestion = personalInfoQuestions + 1 + box1Questions;
    document.querySelector(".recap-page").classList.remove("active");
    allQuestions.forEach(q => q.classList.remove('active'));
    allQuestions[currentQuestion].classList.add("active");
    document.body.setAttribute('data-editing-box', '2');
    
    updateButtons();
    updateProgressBar();
}

// Nouvelle fonction pour revenir √† la question de livraison
function goToDelivery() {
    document.querySelector(".nav-container").style.display = "flex";
    currentQuestion = personalInfoQuestions + 1 + box1Questions + box2Questions;
    document.querySelector(".recap-page").classList.remove("active");
    allQuestions.forEach(q => q.classList.remove('active'));
    allQuestions[currentQuestion].classList.add("active");
    
    updateButtons();
    updateProgressBar();
}

function confirmOrder() {
    document.body.removeAttribute('data-editing-box');
    validerCommande();
    let isValid = true;
    document.querySelectorAll('[required]').forEach(field => {
        if (!field.value) {
            isValid = false;
            const errorMsg = field.closest('.question')?.querySelector('.error-message');
            if (errorMsg) errorMsg.style.display = 'block';
        }
    });
    
    if (!isValid) {
        alert("Veuillez remplir tous les champs obligatoires");
        return;
    }
    document.querySelector(".recap-page").classList.remove("active");
    document.querySelector(".thank-you-page").classList.add("active");
    document.querySelector(".nav-container").style.display = "none";
    
    // Nouveau code : afficher le message appropri√© selon le choix de livraison
    const deliveryChoice = responses.box1.livre;
    const deliveryMessageElement = document.getElementById('delivery-message');
    
    if (deliveryChoice === 'Livraison chez moi (+0,40‚Ç¨)') {
        deliveryMessageElement.textContent = 'Tu seras livr√© entre 19h et 20h !';
    } else if (deliveryChoice === 'Je viens la chercher') {
        deliveryMessageElement.textContent = 'Viens la chercher vers 20h en b43';
    }

    const form = document.querySelector(".contact-us");
    
    try {
        const formData = new FormData(form);
        fetch(form.action, {
            method: "POST",
            body: new URLSearchParams(formData),
            headers: {
                "Content-Type": "application/x-www-form-urlencoded"
            },
            mode: 'no-cors'
        }).then(() => {
            console.log("Formulaire soumis avec succ√®s (fetch)");
        }).catch(e => {
            console.error("Erreur fetch:", e);
            submitWithIframe();
        });
    } catch (e) {
        console.error("Erreur:", e);
        submitWithIframe();
    }
}

function submitWithIframe() {
    const form = document.querySelector(".contact-us");
    const iframe = document.createElement("iframe");
    iframe.name = "form-target-" + Date.now();
    iframe.style.display = "none";
    document.body.appendChild(iframe);
    
    form.target = iframe.name;
    form.submit();
    
    setTimeout(() => {
        iframe.remove();
    }, 5000);
}

document.querySelector(".contact-us").addEventListener("submit", function(e) {
    e.preventDefault();
    confirmOrder();
});

function updateButtons() {
    if (document.querySelector(".recap-page").classList.contains("active")) {
        nextBtn.style.display = "none";
        submitBtn.style.display = "none";
    } else {
        const currentQuestion = document.querySelector(".question.active");
        if (currentQuestion && (currentQuestion.querySelector(".ingredient-container") || currentQuestion.querySelector(".btn-group"))) {
            nextBtn.style.display = "none";
        } else {
            nextBtn.style.display = "block";
        }
        submitBtn.style.display = "none";
    }
}

// Fonction pour v√©rifier le stock
function fetchStock() {
    const stockDisplay = document.getElementById('stock-display');
    const orderBtn = document.querySelector('.order-btn');
    
    orderBtn.disabled = true;
    orderBtn.textContent = "Chargement...";
    stockDisplay.textContent = "V√©rification du stock...";

    fetch('https://script.google.com/macros/s/AKfycbwHGDDnZFpdeaKeH-R1x_Ws2Hm8-WFtyYma7RB-vo3dKc4f3t4cs-aBfm4U455_sckgXA/exec')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Stocker le nombre de bo√Ætes disponibles
                availableBoxes = data.stock;
                
                stockDisplay.textContent = `Bo√Ætes disponibles : ${availableBoxes}`;
                
                if (availableBoxes <= 0) {
                    orderBtn.disabled = true;
                    orderBtn.textContent = "RUPTURE DE STOCK";
                    orderBtn.style.background = "#e74c3c";
                } else {
                    orderBtn.disabled = false;
                    orderBtn.textContent = "Commander";
                    orderBtn.style.background = "";
                }
            }
        })
        .catch(error => {
            console.error('Erreur:', error);
            stockDisplay.textContent = 'Erreur de chargement';
            orderBtn.disabled = true;
            orderBtn.textContent = "Commander (hors ligne)";
        });
}

const scriptURL = "https://script.google.com/macros/s/AKfycbyFoxX80BIT1o7NPB-YvXrSoVci1hUYtBTlnVXiGQz-Xxgd_F0zOSV0LXqFGtOQuBQYTw/exec";

// On intercepte le clic sur le bouton
document.getElementById("main-order-btn").addEventListener("click", () => {
    // Appel normal (affiche le formulaire)
    showForm();

    // Ensuite on appelle le script Google pour r√©server les bo√Ætes
    fetch(scriptURL, {
        method: "POST",
        mode: "cors"
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            console.log("R√©servation effectu√©e !");
            // Tu peux aussi afficher un message √† l'utilisateur si tu veux
        } else {
            console.error("Erreur c√¥t√© script :", data.message || data.error);
        }
    })
    .catch(error => {
        console.error("Erreur r√©seau :", error);
    });
});

function validerCommande() {
    fetch('https://script.google.com/macros/s/AKfycbw2XcAj_HIn4b87YoPQVcFPQOZIvhoHtueX2Kqx1ZHfx_0ShmgWNBISW_BGvsb_OItX9A/exec?valider=1')
    .then((res) => res.json())
}

// Initialisation au chargement de la page
document.addEventListener('DOMContentLoaded', function() {
    fetchStock();
});

</script>
</body>
</html>